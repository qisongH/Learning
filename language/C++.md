# 目录

* [new和malloc的区别](#new和malloc的区别)
* * [自由存储区和堆的区别](#自由存储区和堆的区别)
  * [内存分配](内存分配)
* 





## new和malloc的区别

1、new、delete是C++中独有的**操作符**，而malloc和free是C/C++中的**标准库函数**。

2、使用new创建对象再分配内存的同时会**自动调用构造函数**，同时也可以完成对对象的**初始化**，同理要记得delete也能自动调用析构函数，而malloc只是单纯的为变量分配内存，free也只是释放变量的内存。

3、new返回的是指定类型的指针，并且可以自动计算所申请内存的大小。而malloc返回的是**void**类型，需要将其强制转化为实际类型的指针，并且需要指定好要申请内存的大小。

4、C++允许**重载**new/delete操作符，而malloc和free是一个函数，并不能重载。

5、new内存分配失败时，会抛出bac_alloc**异常**，malloc分配内存失败时**返回NULL**。

6、new从**自由存储区**上为对象动态分配空间，而malloc函数从**堆**上动态分配内存。

### 自由存储区和堆的区别

>1、自由存储区是C++中通过new和delete动态分配和释放对象的**抽象概念**，而**堆（heap）**是C语言和操作系统的术语，是操作系统维护的一块动态分配的内存。
>
>2、基本上所有的C++编译器默认使用堆来实现自由存储，缺省的new和delete其实是按照malloc和free的方式来实现的，此时可以认为 *自由存储区等价于堆* ；如果通过重载运算符的方式，改用其他内存来实现自由存储，比如全局变量做的对象池，此时自由存储区就区别于堆了。
>
>3、堆和自由存储区是有区别的，并非等价。
>
>参考：https://www.cnblogs.com/QG-whz/p/5060894.html

### 内存分配

Linux维护一个**break指针**，这个指针指向堆空间的某个地址。从堆起始地址到break之间的地址空间是映射好的，可以供进程访问；而从break指针往上，如果访问这段空间则程序报错。用malloc进行内存分配就是从break往上进行。

* malloc的整体实现方案

malloc函数实质是**有一个可用的内存块（连接成了一个长长的列表-空闲链表）**。调用malloc()函数时，沿着空闲链表寻找一个足以

